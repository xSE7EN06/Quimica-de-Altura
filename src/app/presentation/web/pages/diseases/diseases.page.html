<div class="diseases-page">
    <!-- Charts Section -->
    <div class="charts-section">
        <!-- Bar Chart -->
        <div class="chart-container">
            <div class="chart-wrapper">
                <div class="y-axis">
                    <span>100</span>
                    <span>75</span>
                    <span>50</span>
                    <span>25</span>
                    <span>0</span>
                </div>
                <div class="bar-chart">
                    <div class="grid-lines">
                        <div class="line"></div>
                        <div class="line"></div>
                        <div class="line"></div>
                        <div class="line"></div>
                        <div class="line"></div>
                    </div>
                    <div class="bars-area">
                        <div class="bar-group">
                            <div class="bar" style="height: 100%; background-color: #56774f;"></div>
                            <span class="label">Producto A</span>
                        </div>
                        <div class="bar-group">
                            <div class="bar" style="height: 75%; background-color: #56774f;"></div>
                            <span class="label">Producto B</span>
                        </div>
                        <div class="bar-group">
                            <div class="bar" style="height: 95%; background-color: #A9BFA3;"></div>
                            <span class="label">Producto C</span>
                        </div>
                        <div class="bar-group">
                            <div class="bar" style="height: 25%; background-color: #1a4d2e;"></div>
                            <span class="label">Producto D</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="x-axis-title">Categoria</div>
        </div>

        <!-- Predominant Categories -->
        <div class="predominant-section">
            <div class="section-title">Categoría de enfermedades predominantes</div>

            <div *ngFor="let stat of diseaseStats" class="category-bar-container" [ngClass]="stat.class">
                <div class="progress-fill" [style.width.%]="stat.percentage"></div>
                <div class="category-text" [ngClass]="stat.textClass">
                    {{ stat.label }}: {{ stat.percentage }}%
                </div>
            </div>
        </div>
    </div>

    <!-- Data Table -->
    <app-data-table [data]="diseases" [columns]="columns" (rowClick)="onViewDisease($event)"
        (editAction)="onEditDisease($event)" (deleteAction)="onBulkDelete($event)" (resetFilters)="onResetFilters()">

        <div search-bar class="search-bar">
            <mat-icon class="search-icon">search</mat-icon>
            <input type="text" [(ngModel)]="searchTerm" (ngModelChange)="onSearch($event)" placeholder="Buscar..." />
            <mat-icon class="clear-icon" *ngIf="searchTerm" (click)="searchTerm = ''; onSearch('')">close</mat-icon>
        </div>

        <button add-button class="btn-primary" (click)="onAddDisease()">
            <mat-icon>add</mat-icon> Agregar Enfermedad
        </button>

        <!-- Dynamic Filter Menu -->
        <div filter-menu class="filter-controls-vertical">
            <div class="filter-group">
                <label>Categoría</label>
                <select [ngModel]="activeFilters.category" (ngModelChange)="onFilterChange('category', $event)">
                    <option value="">Todas las categorías</option>
                    <option value="Digestivas">Digestivas</option>
                    <option value="Respiratorias">Respiratorias</option>
                    <option value="Nerviosas">Nerviosas</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Gravedad</label>
                <select [ngModel]="activeFilters.severity" (ngModelChange)="onFilterChange('severity', $event)">
                    <option value="">Todas las gravedades</option>
                    <option value="Leve">Leve</option>
                    <option value="Moderada">Moderada</option>
                    <option value="Grave">Grave</option>
                </select>
            </div>
        </div>
    </app-data-table>

    <!-- Templates -->
    <ng-template #nameTpl let-item>
        <span class="text-primary">{{ item.name }}</span>
    </ng-template>

</div>